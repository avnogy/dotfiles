# ~/.profile: executed by the command interpreter for login shells.
# This file is not read by bash(1), if ~/.bash_profile or ~/.bash_login
# exists.
export EDITOR="vim"

# Appends a directory to PATH if not already present
appendpath () {
    case ":$PATH:" in
        *:"$1":*)
            ;;
        *)
            PATH="${PATH:+$PATH:}$1"
    esac
}

# Checks if a command or script exists and executes it
check_and_execute() {
    local command="$1"
    shift
    if [ "$command" = "source" ] || [ "$command" = "." ]; then
        local script="$1"
        shift
        if [ -f "$script" ]; then
            source "$script" "$@"
            return $?
        else
            return 127
        fi
    else
        if command -v "$command" >/dev/null 2>&1; then
            "$command" "$@"
            return $?
        elif [ -f "$command" ] && [ -x "$command" ]; then
            "./$command" "$@"
            return $?
        else
            return 127
        fi
    fi
}

# Detects the kernel name, can be linux, wsl or darwin
kernel_name () {
    if uname -a | grep -qi "microsoft"; then
        echo "wsl"
    else
        echo "$(uname -s | tr '[:upper:]' '[:lower:]')"
    fi
}

appendpath '/usr/local/sbin'
appendpath '/usr/local/bin'
appendpath '/usr/bin'
appendpath '~/.local/bin'
appendpath '~/.scripts'


[ "$(kernel_name)" = "wsl" ] && export WINUSERNAME=$(check_and_execute wslvar USERNAME) # Windows username
[ "$(kernel_name)" != "darwin" ] && pidof X && xset b off && xset b 0 0 0 # Disable annoying beep in X server

check_and_execute source ~/.cargo/env

